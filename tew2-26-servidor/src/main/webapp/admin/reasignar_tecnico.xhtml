<ui:composition template="/templates/layout.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <ui:define name="content">

        <f:metadata>
            <f:event type="preRenderView" listener="#{usuarioBean.verificarAdmin}" />
        </f:metadata>
        
        <p:growl id="growlMessages" showDetail="true" life="3000" />
        
        <h:form id="formReasignar">
            <p:panel header="#{msg['reassign.panelHeader']} - #{incidenciaBean.incidenciaSeleccionada.titulo}" 
                     style="width: 600px; margin: auto;">
                
                <p:panelGrid columns="2" styleClass="ui:noborder" style="width: 100%;">

                    <p:outputLabel value="#{msg['reassign.currentTechnician']}" />
                    <p:inputText value="#{incidenciaBean.tecnicoActual.nombreCompleto}" 
                                 readonly="true" 
                                 style="width: 95%;"/>

                    <p:outputLabel for="tecnico" value="#{msg['reassign.newTechnician']}" />
                    <p:selectOneMenu id="tecnico" 
                                     value="#{incidenciaBean.tecnicoSeleccionadoDni}" 
                                     required="true"
                                     requiredMessage="#{msg['reassign.message.required']}"
                                     style="width: 95%;">
                        <f:selectItem itemLabel="#{msg['reassign.selectTechnician']}" itemValue="" noSelectionOption="true"/>

                        <f:selectItems value="#{incidenciaBean.tecnicosDisponibles}" 
                                       var="t" 
                                       itemLabel="#{t.nombreCompleto} (#{t.incidenciasAsignadas} #{msg['reassign.incidents']})" 
                                       itemValue="#{t.dni}" />
                    </p:selectOneMenu>
                    
                </p:panelGrid>

                <p:outputPanel layout="block" style="text-align: center; margin-top: 20px;">
                    
                    <p:button value="#{msg['reassign.button.back']}" 
                              outcome="/common/listar_incidencias.xhtml"
                              icon="pi pi-arrow-left"
                              styleClass="ui-button-secondary"
                              style="margin-right: 10px;"/>
                              
                    <p:commandButton value="#{msg['reassign.button.submit']}" 
                                     action="#{incidenciaBean.doReasignar}"
                                     ajax="false"
                                     icon="pi pi-check" /> 
                </p:outputPanel>
                
            </p:panel>
        </h:form>

    </ui:define>
</ui:composition>